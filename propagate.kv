#:kivy 1.1.0
#:import Win kivy.core.window.Window

<MainWidget>:
    BoxLayout:
        size: Win.size
        id: mainbox
        orientation: 'vertical'
        Button:
            text: 'Load File'
            size_hint_x: .35
            size_hint_y: None
            height: '36dp'
            pos_hint: {'center_x': 0.5, 'y': 0.5}
            on_release: root.show_load()

        GridLayout:
            height: '36dp'
            spacing: '8dp'
            cols: 2
            height: '36dp'
            size_hint_y: None

            Label:
                id: current_slider_value
                text: '0'

            #Label:
            #    id: state_label
            #    text: 'test'

            SpecSlider:
                id: position_slider
                min: -30
                max: 30
                orientation: 'horizontal'
                step: 5
                disabled: True
                on_value: current_slider_value.text = str(position_slider.value)

        FloatLayout:
            spacing: '8dp'
            #cols: 2
            #orientation: 'horizontal'
            height: '36dp'
            size_hint_y: None
            ToggleButton:
                id: phase_button
                size_hint_x: .35
                pos_hint: {'center_x': 0.25, 'top': 1}
                text: 'Phase'
                group: 'display'
                disabled: True
                on_release: amplitude_button.state = 'normal' if phase_button.state == 'down' else 'down'

            ToggleButton:
                id: amplitude_button
                size_hint_x: .35
                pos_hint: {'center_x': 0.75, 'top': 1}
                text: 'Amplitude'
                group: 'display'
                state: 'down'
                disabled: True
                on_release: phase_button.state = 'down' if amplitude_button.state == 'normal' else 'normal'
                on_state: root.update_image(position_slider.value, amplitude_button.state)

<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView:
            id: filechooser

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)

<PopupBox>:
    id: loading_popup
    title: 'Calculating'
    size_hint: (None, None)
    size: Win.width / 2, Win.height / 2
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: loading_label
            text: '0%'
        ProgressBar:
            id: loading_progress
            max: 13
            height: 40
            on_value: loading_label.text = '{:.2f}%'.format(loading_progress.value / loading_progress.max * 100)
